.. _dw_virtual_warehouse_module:
.. include:: <isoamsa.txt>
.. |br| raw:: html

   <br />

.. Macros for table-building
.. Start the module documentation


.. title:: dw_virtual_warehouse -- Create, manage, and destroy CDP Data Warehouse Virtual Warehouses

dw_virtual_warehouse -- Create, manage, and destroy CDP Data Warehouse Virtual Warehouses
=========================================================================================

.. contents::
   :local:
   :depth: 1

Synopsis
--------

- Create CDP Virtual Warehouse



Requirements
------------
The below requirements are needed on the host that executes this module.

- cdpy


Parameters
----------




.. table::
   :widths: 30 20 50

   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **Parameter**              | **Choices/Defaults**  | **Comments**                                                                                                               |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **warehouse_id**           |                       | The identifier of the Virtual Warehouse.                                                                                   |
   |                            |                       | Required if ``state=absent``.                                                                                              |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``str``                    |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   |                            |                       | |br|                                                                                                                       |
   |                            |                       |                                                                                                                            |
   |                            |                       | *Aliases: vw_id, id*                                                                                                       |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **cluster_id**             |                       | The identifier of the parent Data Warehouse Cluster of the Virtual Warehouse.                                              |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``str``                    |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | *Required*                 |                       |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **catalog_id**             |                       | The identifier of the parent Database Catalog attached to the Virtual Warehouse.                                           |
   |                            |                       | Required if ``state=present``                                                                                              |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``str``                    |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   |                            |                       | |br|                                                                                                                       |
   |                            |                       |                                                                                                                            |
   |                            |                       | *Aliases: dbc_id*                                                                                                          |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **type**                   | **Choices:**          | The type of Virtual Warehouse to be created.                                                                               |
   |                            |  - hive               | Required if ``state=present``                                                                                              |
   | |br|                       |  - impala             |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **name**                   |                       | The name of the Virtual Warehouse.                                                                                         |
   |                            |                       | Required if ``state=present``                                                                                              |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``str``                    |                       |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **template**               | **Choices:**          | The name of deployment template for the Virtual Warehouse                                                                  |
   |                            |  - xsmall             |                                                                                                                            |
   | |br|                       |  - small              |                                                                                                                            |
   |                            |  - medium             |                                                                                                                            |
   | ``str``                    |  - large              |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **autoscaling_min_nodes**  |                       | The minimum number of available nodes for Virtual Warehouse autoscaling.                                                   |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``int``                    |                       |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **autoscaling_max_nodes**  |                       | The maximum number of available nodes for Virtual Warehouse autoscaling.                                                   |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``int``                    |                       |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **common_configs**         |                       | Configurations that are applied to every application in the Virtual Warehouse service.                                     |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``dict``                   |                       |                                                                                                                            |
   +-+--------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | **configBlocks**         |                       | List of *ConfigBlocks* for the application.                                                                                |
   | |                          |                       |                                                                                                                            |
   | | |br|                     |                       |                                                                                                                            |
   | |                          |                       |                                                                                                                            |
   | | ``list``                 |                       |                                                                                                                            |
   +-+-+------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | **id**                 |                       | ID of the ConfigBlock.                                                                                                     |
   | | |                        |                       | Unique within an *ApplicationConfig*.                                                                                      |
   | | | |br|                   |                       |                                                                                                                            |
   | | |                        |                       |                                                                                                                            |
   | | | ``str``                |                       |                                                                                                                            |
   +-+-+------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | **format**             | **Choices:**          | Format of the ConfigBlock.                                                                                                 |
   | | |                        |  - HADOOP_XML         |                                                                                                                            |
   | | | |br|                   |  - PROPERTIES         |                                                                                                                            |
   | | |                        |  - TEXT               |                                                                                                                            |
   | | | ``str``                |  - JSON               |                                                                                                                            |
   | | |                        |  - BINARY             |                                                                                                                            |
   | | | |br|                   |  - ENV                |                                                                                                                            |
   | | |                        |  - FLAGFILE           |                                                                                                                            |
   +-+-+------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | **content**            |                       | Contents of the ConfigBlock.                                                                                               |
   | | |                        |                       |                                                                                                                            |
   | | | |br|                   |                       |                                                                                                                            |
   | | |                        |                       |                                                                                                                            |
   | | | ``dict``               |                       |                                                                                                                            |
   +-+-+-+----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | | **keyValues**        |                       | Key-value type configuration.                                                                                              |
   | | | |                      |                       |                                                                                                                            |
   | | | | |br|                 |                       |                                                                                                                            |
   | | | |                      |                       |                                                                                                                            |
   | | | | ``dict``             |                       |                                                                                                                            |
   +-+-+-+----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | | **text**             |                       | Text type configuration.                                                                                                   |
   | | | |                      |                       |                                                                                                                            |
   | | | | |br|                 |                       |                                                                                                                            |
   | | | |                      |                       |                                                                                                                            |
   | | | | ``str``              |                       |                                                                                                                            |
   +-+-+-+----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | | **json**             |                       | JSON type configuration.                                                                                                   |
   | | | |                      |                       |                                                                                                                            |
   | | | | |br|                 |                       |                                                                                                                            |
   | | | |                      |                       |                                                                                                                            |
   | | | | ``str``              |                       |                                                                                                                            |
   +-+-+-+----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **application_configs**    |                       | Configurations that are applied to specific applications in the Virtual Warehouse service.                                 |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``dict``                   |                       |                                                                                                                            |
   +-+--------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | **__application_name__** |                       | The application name or identifier.                                                                                        |
   | |                          |                       |                                                                                                                            |
   | | |br|                     |                       |                                                                                                                            |
   | |                          |                       |                                                                                                                            |
   | | ``dict``                 |                       |                                                                                                                            |
   +-+-+------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | **configBlocks**       |                       | List of *ConfigBlocks* for the specified application.                                                                      |
   | | |                        |                       |                                                                                                                            |
   | | | |br|                   |                       |                                                                                                                            |
   | | |                        |                       |                                                                                                                            |
   | | | ``list``               |                       |                                                                                                                            |
   +-+-+-+----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | | **id**               |                       | ID of the ConfigBlock.                                                                                                     |
   | | | |                      |                       | Unique within an ApplicationConfig.                                                                                        |
   | | | | |br|                 |                       |                                                                                                                            |
   | | | |                      |                       |                                                                                                                            |
   | | | | ``str``              |                       |                                                                                                                            |
   +-+-+-+----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | | **format**           |                       | Format of ConfigBlock.                                                                                                     |
   | | | |                      |                       |                                                                                                                            |
   | | | | |br|                 |                       |                                                                                                                            |
   | | | |                      |                       |                                                                                                                            |
   | | | | ``str``              |                       |                                                                                                                            |
   +-+-+-+----------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | | **content**          |                       | Contents of a ConfigBlock.                                                                                                 |
   | | | |                      |                       |                                                                                                                            |
   | | | | |br|                 |                       |                                                                                                                            |
   | | | |                      |                       |                                                                                                                            |
   | | | | ``dict``             |                       |                                                                                                                            |
   +-+-+-+-+--------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | | | **keyValues**      |                       | Key-value type configuration.                                                                                              |
   | | | | |                    |                       |                                                                                                                            |
   | | | | | |br|               |                       |                                                                                                                            |
   | | | | |                    |                       |                                                                                                                            |
   | | | | | ``dict``           |                       |                                                                                                                            |
   +-+-+-+-+--------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | | | **text**           |                       | Text type configuration.                                                                                                   |
   | | | | |                    |                       |                                                                                                                            |
   | | | | | |br|               |                       |                                                                                                                            |
   | | | | |                    |                       |                                                                                                                            |
   | | | | | ``str``            |                       |                                                                                                                            |
   +-+-+-+-+--------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | | | | | **json**           |                       | JSON type configuration.                                                                                                   |
   | | | | |                    |                       |                                                                                                                            |
   | | | | | |br|               |                       |                                                                                                                            |
   | | | | |                    |                       |                                                                                                                            |
   | | | | | ``str``            |                       |                                                                                                                            |
   +-+-+-+-+--------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **ldap_groups**            |                       | LDAP Groupnames to enabled for authentication to the Virtual Warehouse.                                                    |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``list``                   |                       |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **enable_sso**             |                       | Flag to enable Single Sign-On (SSO) for the Virtual Warehouse.                                                             |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``bool``                   |                       |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **tags**                   |                       | Key-value tags associated with the Virtual Warehouse cloud provider resources.                                             |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``dict``                   |                       |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **state**                  | **Choices:**          | The declarative state of the Virtual Warehouse                                                                             |
   |                            |  - **present** |larr| |                                                                                                                            |
   | |br|                       |  - absent             |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **wait**                   |                       | Flag to enable internal polling to wait for the Virtual Warehouse to achieve the declared state.                           |
   |                            |                       | If set to FALSE, the module will return immediately.                                                                       |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``bool``                   |                       |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **delay**                  |                       | The internal polling interval (in seconds) while the module waits for the Virtual Warehouse to achieve the declared state. |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``int``                    |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   |                            |                       | |br|                                                                                                                       |
   |                            |                       |                                                                                                                            |
   |                            |                       | *Aliases: polling_delay*                                                                                                   |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **timeout**                |                       | The internal polling timeout (in seconds) while the module waits for the Virtual Warehouse to achieve the declared state.  |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``int``                    |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   |                            |                       | |br|                                                                                                                       |
   |                            |                       |                                                                                                                            |
   |                            |                       | *Aliases: polling_timeout*                                                                                                 |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **verify_tls**             |                       | Verify the TLS certificates for the CDP endpoint.                                                                          |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``bool``                   |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   |                            |                       | |br|                                                                                                                       |
   |                            |                       |                                                                                                                            |
   |                            |                       | *Aliases: tls*                                                                                                             |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **debug**                  |                       | Capture the CDP SDK debug log.                                                                                             |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``bool``                   |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   |                            |                       | |br|                                                                                                                       |
   |                            |                       |                                                                                                                            |
   |                            |                       | *Aliases: debug_endpoints*                                                                                                 |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+
   | **profile**                |                       | If provided, the CDP SDK will use this value as its profile.                                                               |
   |                            |                       |                                                                                                                            |
   | |br|                       |                       |                                                                                                                            |
   |                            |                       |                                                                                                                            |
   | ``str``                    |                       |                                                                                                                            |
   +----------------------------+-----------------------+----------------------------------------------------------------------------------------------------------------------------+






Examples
--------

.. code-block:: yaml+jinja

  
  # Note: These examples do not set authentication details.

  # Create a Virtual Warehouse
  - cloudera.cloud.dw_virtual_warehouse:
      cluster_id: example-cluster-id
      name: example-virtual-warehouse
      type: hive
      template: xsmall
      autoscaling_min_nodes: 3
      autoscaling_max_nodes: 19
      tags:
         some_key: "some value"
      enable_sso: true
      ldap_groups: ['group1', 'group2', 'group3']

  # Create a Virtual Warehouse with configurations
  - cloudera.cloud.dw_virtual_warehouse:
      cluster_id: example-cluster-id
      name: example-virtual-warehouse
      type: "hive"
      template: "xsmall"
      enable_sso: true
      ldap_groups: ['group1','group2','group3']
      common_configs:
          configBlocks:
              - id: das-ranger-policymgr
                format: HADOOP_XML
                content:
                    keyValues:
                        'xasecure.policymgr.clientssl.truststore': '/path_to_ca_cert/cacerts'
      application_configs: 
          das-webapp:
              configBlocks:
                  - id: hive-kerberos-config
                    format: TEXT
                    content:
                        text: "\n[libdefaults]\n\trenew_lifetime = 7d"   
                        
  # Delete a Virtual Warehouse
  - cloudera.cloud.dw_virtual_warehouse:
      cluster_id: example-cluster-id
      warehouse_id: example-virtual-warehouse-id
      state: absent      




Return Values
-------------

Common return values are documented here, the following are fields unique to this module.


.. table::
   :widths: 30 20 50

   +-----------------------+----------------+----------------------------------------------------------------+
   | **Key**               | **Returned**   | **Description**                                                |
   +-----------------------+----------------+----------------------------------------------------------------+
   | **virtual_warehouse** |                | The details about the CDP Data Warehouse Virtual Warehouse.    |
   |                       |                |                                                                |
   | |br|                  |                |                                                                |
   |                       |                |                                                                |
   | ``dict``              |                |                                                                |
   +-+---------------------+----------------+----------------------------------------------------------------+
   | | **id**              | always         | The identifier of the Virtual Warehouse.                       |
   | |                     |                |                                                                |
   | | |br|                |                |                                                                |
   | |                     |                |                                                                |
   | | ``str``             |                |                                                                |
   +-+---------------------+----------------+----------------------------------------------------------------+
   | | **name**            | always         | The name of the Virtual Warehouse.                             |
   | |                     |                |                                                                |
   | | |br|                |                |                                                                |
   | |                     |                |                                                                |
   | | ``str``             |                |                                                                |
   +-+---------------------+----------------+----------------------------------------------------------------+
   | | **vwType**          | always         | The Virtual Warehouse type.                                    |
   | |                     |                |                                                                |
   | | |br|                |                |                                                                |
   | |                     |                |                                                                |
   | | ``str``             |                |                                                                |
   +-+---------------------+----------------+----------------------------------------------------------------+
   | | **dbcId**           | always         | The Database Catalog ID associated with the Virtual Warehouse. |
   | |                     |                |                                                                |
   | | |br|                |                |                                                                |
   | |                     |                |                                                                |
   | | ``str``             |                |                                                                |
   +-+---------------------+----------------+----------------------------------------------------------------+
   | | **creationDate**    | always         | The creation time of the Virtual Warehouse in UTC.             |
   | |                     |                |                                                                |
   | | |br|                |                |                                                                |
   | |                     |                |                                                                |
   | | ``str``             |                |                                                                |
   +-+---------------------+----------------+----------------------------------------------------------------+
   | | **status**          | always         | The status of the Virtual Warehouse.                           |
   | |                     |                |                                                                |
   | | |br|                |                |                                                                |
   | |                     |                |                                                                |
   | | ``str``             |                |                                                                |
   +-+---------------------+----------------+----------------------------------------------------------------+
   | | **creator**         | always         | Details about the Virtual Warehouse creator.                   |
   | |                     |                |                                                                |
   | | |br|                |                |                                                                |
   | |                     |                |                                                                |
   | | ``dict``            |                |                                                                |
   +-+---------------------+----------------+----------------------------------------------------------------+
   | | **tags**            | always         | Custom tags applied to the Virtual Warehouse.                  |
   | |                     |                |                                                                |
   | | |br|                |                |                                                                |
   | |                     |                |                                                                |
   | | ``dict``            |                |                                                                |
   +-+---------------------+----------------+----------------------------------------------------------------+
   | **sdk_out**           | when supported | Returns the captured CDP SDK log.                              |
   |                       |                |                                                                |
   | |br|                  |                |                                                                |
   |                       |                |                                                                |
   | ``str``               |                |                                                                |
   +-----------------------+----------------+----------------------------------------------------------------+
   | **sdk_out_lines**     | when supported | Returns a list of each line of the captured CDP SDK log.       |
   |                       |                |                                                                |
   | |br|                  |                |                                                                |
   |                       |                |                                                                |
   | ``list``              |                |                                                                |
   +-----------------------+----------------+----------------------------------------------------------------+


Status
------




- This module is not guaranteed to have a backwards compatible interface. *[preview]*


- This module is maintained by community.



Authors
~~~~~~~

- Webster Mudge (@wmudge)
- Dan Chaffelson (@chaffelson)
- Saravanan Raju (@raju-saravanan)

